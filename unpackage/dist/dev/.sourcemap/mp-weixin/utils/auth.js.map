{"version":3,"file":"auth.js","sources":["utils/auth.js"],"sourcesContent":["/**\n * 用户认证工具类\n */\nclass Auth {\n  /**\n   * 检查用户是否已登录\n   */\n  static isLoggedIn() {\n    return uni.getStorageSync(\"isLoggedIn\") === true;\n  }\n\n  /**\n   * 获取用户信息\n   */\n  static getUserInfo() {\n    return uni.getStorageSync(\"userInfo\") || null;\n  }\n\n  /**\n   * 保存用户信息\n   */\n  static setUserInfo(userInfo) {\n    uni.setStorageSync(\"userInfo\", userInfo);\n    uni.setStorageSync(\"isLoggedIn\", true);\n  }\n\n  /**\n   * 清除用户信息\n   */\n  static clearUserInfo() {\n    uni.removeStorageSync(\"userInfo\");\n    uni.removeStorageSync(\"isLoggedIn\");\n  }\n\n  /**\n   * 获取用户昵称\n   */\n  static getNickname() {\n    const userInfo = this.getUserInfo();\n    return userInfo ? userInfo.nickName : \"\";\n  }\n\n  /**\n   * 检查是否需要设置昵称\n   */\n  static needSetNickname() {\n    const userInfo = this.getUserInfo();\n    return !userInfo || !userInfo.nickName || userInfo.nickName === \"微信用户\";\n  }\n\n  /**\n   * 微信授权登录\n   */\n  static async wechatLogin() {\n    return new Promise((resolve, reject) => {\n      uni.getUserProfile({\n        desc: \"用于完善用户资料\",\n        success: (res) => {\n          console.log(\"获取用户信息成功:\", res.userInfo);\n          resolve(res.userInfo);\n        },\n        fail: (err) => {\n          console.error(\"获取用户信息失败:\", err);\n          reject(err);\n        },\n      });\n    });\n  }\n\n  /**\n   * 退出登录\n   */\n  static logout() {\n    this.clearUserInfo();\n    uni.showToast({\n      title: \"已退出登录\",\n      icon: \"success\",\n    });\n\n    // 跳转到登录页\n    setTimeout(() => {\n      uni.reLaunch({\n        url: \"/pages/login/login\",\n      });\n    }, 1500);\n  }\n}\n\nexport default Auth;\n"],"names":["Auth","uni","userInfo","resolve","reject","res","err"],"mappings":"oDAGA,MAAMA,CAAK,CAIT,OAAO,YAAa,CAClB,OAAOC,QAAI,eAAe,YAAY,IAAM,EAC7C,CAKD,OAAO,aAAc,CACnB,OAAOA,QAAI,eAAe,UAAU,GAAK,IAC1C,CAKD,OAAO,YAAYC,EAAU,CAC3BD,EAAAA,MAAI,eAAe,WAAYC,CAAQ,EACvCD,EAAAA,MAAI,eAAe,aAAc,EAAI,CACtC,CAKD,OAAO,eAAgB,CACrBA,QAAI,kBAAkB,UAAU,EAChCA,QAAI,kBAAkB,YAAY,CACnC,CAKD,OAAO,aAAc,CACnB,MAAMC,EAAW,KAAK,cACtB,OAAOA,EAAWA,EAAS,SAAW,EACvC,CAKD,OAAO,iBAAkB,CACvB,MAAMA,EAAW,KAAK,cACtB,MAAO,CAACA,GAAY,CAACA,EAAS,UAAYA,EAAS,WAAa,MACjE,CAKD,aAAa,aAAc,CACzB,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtCH,EAAAA,MAAI,eAAe,CACjB,KAAM,WACN,QAAUI,GAAQ,CAChBJ,EAAA,MAAA,MAAA,MAAA,sBAAY,YAAaI,EAAI,QAAQ,EACrCF,EAAQE,EAAI,QAAQ,CACrB,EACD,KAAOC,GAAQ,CACbL,EAAc,MAAA,MAAA,QAAA,sBAAA,YAAaK,CAAG,EAC9BF,EAAOE,CAAG,CACX,CACT,CAAO,CACP,CAAK,CACF,CAKD,OAAO,QAAS,CACd,KAAK,cAAa,EAClBL,EAAAA,MAAI,UAAU,CACZ,MAAO,QACP,KAAM,SACZ,CAAK,EAGD,WAAW,IAAM,CACfA,EAAAA,MAAI,SAAS,CACX,IAAK,oBACb,CAAO,CACF,EAAE,IAAI,CACR,CACH"}