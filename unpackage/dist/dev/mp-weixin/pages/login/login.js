"use strict";const e=require("../../common/vendor.js"),c=require("../../utils/auth.js"),t=require("../../common/assets.js"),a={name:"Login",data(){return{isLoading:!1,nickname:"",userInfo:null,showNicknamePopup:!1}},methods:{async handleWechatLogin(){this.isLoading=!0;try{const n=await c.Auth.wechatLogin();n&&(this.userInfo=n,c.Auth.needSetNickname()?this.showNicknamePopup=!0:this.loginSuccess(n))}catch(n){e.index.__f__("error","at pages/login/login.vue:93","登录失败:",n),e.index.showToast({title:"登录失败，请重试",icon:"none"})}finally{this.isLoading=!1}},onNicknameInput(n){this.nickname=n.detail.value},closePopup(){this.showNicknamePopup=!1},async confirmNickname(){if(!this.nickname.trim()){e.index.showToast({title:"请输入昵称",icon:"none"});return}try{const n={...this.userInfo,nickName:this.nickname.trim()};c.Auth.setUserInfo(n),this.showNicknamePopup=!1,this.loginSuccess(n),e.index.showToast({title:"昵称设置成功",icon:"success"})}catch(n){e.index.__f__("error","at pages/login/login.vue:144","设置昵称失败:",n),e.index.showToast({title:"设置失败，请重试",icon:"none"})}},loginSuccess(n){e.index.showToast({title:"登录成功",icon:"success"}),setTimeout(()=>{e.index.switchTab({url:"/pages/index/index"})},1500)}},onLoad(){c.Auth.isLoggedIn()&&e.index.switchTab({url:"/pages/index/index"})}};function r(n,h,m,l,o,s){return e.e({a:t._imports_0,b:e.o((...i)=>s.handleWechatLogin&&s.handleWechatLogin(...i)),c:o.isLoading,d:o.showNicknamePopup},o.showNicknamePopup?{e:e.o([i=>o.nickname=i.detail.value,(...i)=>s.onNicknameInput&&s.onNicknameInput(...i)]),f:o.nickname,g:e.o((...i)=>s.confirmNickname&&s.confirmNickname(...i)),h:!o.nickname.trim(),i:e.o(()=>{}),j:e.o((...i)=>s.closePopup&&s.closePopup(...i))}:{})}const u=e._export_sfc(a,[["render",r],["__scopeId","data-v-e4e4508d"]]);wx.createPage(u);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/login/login.js.map
