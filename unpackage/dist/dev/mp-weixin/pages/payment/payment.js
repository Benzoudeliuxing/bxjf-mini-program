"use strict";const t=require("../../common/vendor.js"),i=require("../../utils/payment.js"),d=require("../../common/assets.js"),m={name:"Payment",data(){return{orderInfo:{orderId:"",orderNo:"",productName:"",amount:0,payAmount:0},selectedMethod:"wechat",isPaying:!1}},onLoad(e){this.getOrderInfo(e)},methods:{getOrderInfo(e){const o=e.orderNo||"ORDER"+Date.now(),n=parseInt(e.amount)||9900,a=e.title||"商品名称";this.orderInfo={orderId:e.id||"ORDER"+Date.now(),orderNo:o,productName:a,amount:n,payAmount:n}},selectPaymentMethod(e){this.selectedMethod=e},async handlePayment(){if(!this.isPaying){this.isPaying=!0;try{const e=await i.wechatPay(this.orderInfo);e.success?this.paymentSuccess():this.paymentFail(e.error)}catch(e){this.paymentFail(e)}finally{this.isPaying=!1}}},paymentSuccess(){t.index.showToast({title:"支付成功",icon:"success"}),setTimeout(()=>{t.index.redirectTo({url:`/pages/payment-success/payment-success?orderId=${this.orderInfo.orderId}`})},1500)},paymentFail(e){const o=i.getErrorMessage(e);t.index.showToast({title:o,icon:"none"})}}};function u(e,o,n,a,r,s){return{a:t.t(r.orderInfo.orderNo),b:t.t(r.orderInfo.productName),c:t.t((r.orderInfo.amount/100).toFixed(2)),d:t.t((r.orderInfo.payAmount/100).toFixed(2)),e:d._imports_0$1,f:r.selectedMethod==="wechat"?1:"",g:t.o(c=>s.selectPaymentMethod("wechat")),h:t.t(r.isPaying?"支付中...":"立即支付"),i:t.o((...c)=>s.handlePayment&&s.handlePayment(...c)),j:r.isPaying}}const h=t._export_sfc(m,[["render",u],["__scopeId","data-v-eade9ab2"]]);wx.createPage(h);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/payment/payment.js.map
